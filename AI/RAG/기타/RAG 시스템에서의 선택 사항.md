![[Pasted image 20241023235029.png

RAG 시스템을 구성할 때 청킹, 임베딩, 벡터 저장 및 검색, 그리고 유사도 계산의 각 단계에서 다양한 선택지가 존재합니다. 이 게시글에서는 각 단계에서 사용할 수 있는 라이브러리와 방법들을 설명하고, 선택지의 특징을 정리해 보겠습니다. 마지막에 선택 사항들을 표로 정리하여 비교해 보겠습니다.

---

### 1. **청킹(Chunking)**

문서를 작은 단위로 나누는 청킹은 RAG에서 필수적인 과정입니다. 텍스트를 작게 쪼개면 임베딩과 검색에서 더 높은 효율성을 기대할 수 있습니다.

#### **청킹 방법 및 라이브러리**
- **Langchain TextSplitter**:
  - **CharacterTextSplitter**: 문자 개수를 기준으로 텍스트를 나눔. 간단하지만 문맥 고려가 부족함.
  - **RecursiveCharacterTextSplitter**: 구두점이나 특수 문자를 기준으로 텍스트를 나누어 자연스러운 청킹을 지원.

- **Huggingface Tokenizers**:
  - **WordPiece, BPE**: 토큰 단위로 텍스트를 분리하여 임베딩할 때 유용.

- **NLP 도구**:
  - **SpaCy**: 문장 단위 청킹.
  - **NLTK**: 문장 단위 또는 구두점을 기준으로 청킹.

---

### 2. **임베딩(Embedding)**

임베딩은 텍스트를 벡터로 변환하는 단계로, 검색이나 유사도 계산에서 중요한 역할을 합니다.

#### **임베딩 라이브러리 및 모델**
- **OpenAI Embeddings**:
  - **text-embedding-ada-002**: OpenAI의 최신 임베딩 모델로, 고성능 벡터를 생성.
  
- **Sentence Transformers**:
  - **SBERT**: BERT를 기반으로 한 문장 임베딩 모델. 높은 정확도와 속도 제공.

- **Huggingface Transformers**:
  - 다양한 BERT, RoBERTa, DistilBERT 등의 사전 학습된 모델을 제공.

---

### 3. **벡터 저장 및 검색(Vector Storage & Retrieval)**

임베딩된 벡터는 벡터 데이터베이스에 저장되어 검색에 사용됩니다. 각 벡터 저장소는 성능과 확장성에서 차이를 보입니다.

#### **벡터 스토어 라이브러리 및 DB**
- **FAISS (Facebook AI Similarity Search)**:
  - 대규모 벡터 데이터베이스에서 빠르고 효율적인 검색을 지원.
  
- **Pinecone**:
  - 클라우드 기반의 벡터 저장소로, 실시간 벡터 검색을 지원.

- **Weaviate**:
  - 오픈소스 벡터 데이터베이스로, 자연어 처리 및 지식 그래프와 결합 가능.

- **Milvus**:
  - 고성능 대규모 벡터 검색 엔진으로, 클러스터 환경에서 뛰어난 성능을 제공.

- **Chroma**:
  - 벡터 저장과 검색을 위한 오픈소스 벡터 데이터베이스. 간편하게 사용할 수 있고, 최근 각광받는 라이브러리.

---

### 4. **유사도 계산(Similarity Search)**

텍스트 임베딩 간의 유사도를 계산하여 검색에 활용하는 방식입니다.

#### **유사도 계산 방법**
- **Cosine Similarity**:
  - 두 벡터 간의 각도를 기준으로 유사도를 계산. 가장 일반적인 방법.

- **Euclidean Distance**:
  - 벡터 간의 직선 거리를 측정하여 유사도를 계산.

- **Dot Product**:
  - 두 벡터의 내적을 계산하여 유사도를 구함. 빠른 유사도 계산을 원할 때 유용.

- **하이브리드 검색(Hybrid Search)**:
  - **BM25 + Embeddings**: BM25와 임베딩 기반 검색을 결합한 하이브리드 방식. BM25로 기본적인 텍스트 검색을 하고, 임베딩을 통해 유사도를 정밀하게 평가. 다양한 상황에서 좋은 성능을 보임.

---

### 선택 사항 비교 표

| **단계**               | **방법/라이브러리**                                                | **특징**                                              |
|------------------------|-------------------------------------------------------------------|-------------------------------------------------------|
| **청킹(Chunking)**      | **CharacterTextSplitter**                                         | 문자 개수를 기준으로 청킹.                             |
|                        | **RecursiveCharacterTextSplitter**                                | 구두점과 의미 단위를 고려한 청킹.                      |
|                        | **Huggingface Tokenizers**                                        | BPE, WordPiece 등 다양한 토크나이저 지원.              |
|                        | **SpaCy, NLTK**                                                   | 문장 단위 청킹 제공.                                   |
| **임베딩(Embedding)**   | **OpenAI Embeddings**                                             | 최신 임베딩 모델로 높은 성능 제공.                     |
|                        | **Sentence Transformers (SBERT)**                                 | BERT 기반 문장 임베딩으로 정확한 검색 가능.            |
|                        | **Huggingface Transformers**                                      | 다양한 사전 학습된 모델 지원.                          |
| **벡터 저장소**         | **FAISS**                                                         | 대규모 벡터 데이터베이스, 빠른 검색.                    |
|                        | **Pinecone**                                                      | 클라우드 기반, 실시간 검색 및 확장성 제공.             |
|                        | **Weaviate**                                                      | 자연어 처리와 지식 그래프 결합 가능.                   |
|                        | **Milvus**                                                        | 대규모 데이터에서 고성능 검색 제공.                    |
|                        | **Chroma**                                                        | 오픈소스 벡터 저장소, 간단하고 사용하기 쉬움.          |
| **유사도 계산**         | **Cosine Similarity**                                             | 가장 일반적인 방식, 각도를 기준으로 계산.              |
|                        | **Euclidean Distance**                                            | 벡터 간의 거리를 기반으로 유사도를 계산.               |
|                        | **Dot Product**                                                   | 내적을 통한 빠른 유사도 계산.                          |
|                        | **하이브리드 검색 (BM25 + Embeddings)**                           | BM25와 임베딩을 결합한 검색 방식으로 정밀한 검색 가능. |

---

이 게시글을 통해 RAG 시스템을 구현할 때 선택할 수 있는 다양한 라이브러리와 방법들을 정리하였습니다. 각 단계별로 프로젝트의 요구사항에 맞게 도구를 선택하여 최적의 성능을 낼 수 있는 시스템을 구축할 수 있습니다.

**더 알아볼 주제**:
1. **RAG 성능 최적화 방법**: 다양한 도구와 방법들을 결합해 성능을 극대화하는 팁.
2. **하이브리드 검색의 실제 구현**: BM25와 임베딩 기반 검색을 결합하여 사용하는 방법.
3. **Chroma의 활용 사례**: 최근 주목받는 벡터 데이터베이스인 Chroma의 실제 활용 사례.